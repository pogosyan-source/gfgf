<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
    <title>Web Funnel â€” Payment</title>
    <link rel="preconnect" href="https://fonts.googleapis.com"/>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet"/>
    <style>
    :root{
      --bg: #FFFFFF;
      --text: #373A49;
      --muted: #E7E7E7;
      --tile-bg: #FFFFFFe6;
      --active: #FF2475;
      --active-text: #000000;
      --radius: 10px;
      --gap: 8px;
      --btn-h: 48px;
      --container-pad: 16px;
    }

    html, body {
      margin: 0;
      padding: 0;
      background: var(--bg);
      color: var(--text);
      font: 16px/1.45 system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
    }

    .screen{
      min-height: 100vh;
      display: grid;
      grid-template-rows: auto auto 1fr auto;
      background: var(--bg);
    }

    /* Header */
    .header{
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px var(--container-pad);
    }
    .header .back{
      width: 28px; height: 28px;
      display: inline-grid; place-items: center; cursor: pointer;
      border: none; background: transparent;
    }
    .header .back:before{
      content: "";
      width: 14px; height: 14px; display: block;
      border-left: 3px solid var(--active);
      border-bottom: 3px solid var(--active);
      transform: rotate(45deg);
      border-radius: 1px;
    }

    .topbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px var(--container-pad);
      background: var(--bg);
    }

    .back-btn {
      width: 28px; 
      height: 28px;
      display: inline-grid; 
      place-items: center; 
      cursor: pointer;
      border: none; 
      background: transparent;
      padding: 0;
    }

    .back-btn svg {
      width: 20px;
      height: 20px;
    }

    .back-btn svg path {
      stroke: var(--active);
      stroke-width: 2.5;
    }


    /* Content */
    .payment-screen {
      background: var(--bg);
      color: var(--text);
    }

    .payment-section {
      padding: 20px var(--container-pad) 0;
      max-width: 720px;
      margin: 0 auto;
      text-align: center;
    }

    .payment-title {
      font-size: 24px;
      font-weight: 600;
      color: var(--text);
      margin: 0 0 24px;
      line-height: 1.3;
    }

    .payment-plan {
      position: relative;
      background: var(--bg);
      border: 2px solid var(--active);
      border-radius: 16px;
      padding: 20px;
      margin: 0 0 24px;
      box-shadow: 0 8px 32px rgba(255, 36, 117, 0.15);
    }

    .payment-container {
      position: relative;
      margin-bottom: 16px;
    }

    .payment-recommended {
      display: inline-block;
      background: var(--active);
      color: var(--active-text);
      padding: 6px 16px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .payment-plan-wrapper {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 16px;
    }

    .wrapper {
      text-align: left;
      flex: 1;
    }

    .text-bold-24 {
      font-size: 18px;
      font-weight: 600;
      color: var(--text);
      line-height: 1.2;
    }

    .money {
      display: flex;
      align-items: baseline;
      gap: 4px;
    }

    .payment-plan-price {
      font-size: 32px;
      font-weight: 700;
      color: var(--active);
      line-height: 1;
    }

    .text-dark-14 {
      font-size: 14px;
      color: var(--text);
      opacity: 0.7;
    }

    #loader-spinner {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 1000;
    }

    .iframe-container {
      padding: 0 var(--container-pad) 100px;
      max-width: 720px;
      margin: 0 auto;
      width: 100%;
      min-height: 70svh;
      box-sizing: border-box;
    }

    .payment {
      position: relative;
      border-radius: var(--radius);
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      display: none;
      min-height: min(520px, 70svh);
    }

    .payment.active { display: block; height: auto; }

    .payment-iframe {
      width: 100%;
      height: 75svh;
      min-height: 60svh;
      border: none;
      background: transparent;
      display: block;
    }

    /* Responsive */
    @media (max-width: 480px) {
      .payment-plan-wrapper {
        flex-direction: column;
        text-align: center;
        gap: 12px;
      }
      
      .wrapper {
        text-align: center;
      }
      
      .payment-title {
        font-size: 20px;
      }
      .iframe-container { min-height: 80svh; }
      .payment { min-height: 75svh; }
      .payment-iframe { height: auto; min-height: 70svh; }
    }
    /* Paywall form */
    .paywall-form{ display:grid; gap:clamp(0.6rem,1.8vw,1.2rem); max-width: min(80ch, 100%); margin: 0 auto; padding: clamp(0.8rem,2.5vw,1.6rem); border:1px solid var(--muted); border-radius: clamp(0.6rem,2vw,1rem); background: var(--tile-bg); box-shadow: 0 8px 32px rgba(0,0,0,0.06); }
    .paywall-row{ display:grid; gap:clamp(0.3rem,1.2vw,0.6rem); }
    .paywall-label{ font-size: clamp(0.9rem,2.2vw,1.1rem); font-weight:600; }
    .paywall-input{ height: clamp(2.4rem,6svh,3.2rem); padding: 0 clamp(0.8rem,2.4vw,1.2rem); border:1px solid var(--muted); border-radius: clamp(0.6rem,2vw,1rem); font-size: clamp(1rem,2.6vw,1.1rem); }
    .btn-primary{ height: clamp(2.6rem,6.5svh,3.4rem); border:none; border-radius: clamp(0.6rem,2vw,1rem); background: var(--active); color: var(--active-text); font-weight:700; font-size: clamp(1rem,2.6vw,1.1rem); cursor: pointer; padding: 0 clamp(1rem,3vw,1.6rem); }
    .error-box{ color:#ef4444; font-size: clamp(0.9rem,2.4vw,1rem); min-height: 1.2em; }

    /* Plan selector */
    .plans{ display:grid; gap: clamp(0.6rem,2vw,0.9rem); margin: 0 0 clamp(1rem,3vw,1.6rem); }
    .plan-card{ position: relative; display:flex; align-items:center; gap: clamp(0.6rem,2vw,1rem); padding: clamp(0.8rem,2.6vw,1.2rem); border: 2px solid var(--muted); border-radius: clamp(0.7rem,2.2vw,1rem); background:#0a0a0a08; }
    .plan-card.active{ border-color: var(--active); box-shadow: 0 8px 24px rgba(255,36,117,0.15); }
    .plan-radio{ width: clamp(1rem,3vw,1.25rem); height: clamp(1rem,3vw,1.25rem); border-radius: 50%; border: 2px solid #1e1e1e; box-shadow: inset 0 0 0 2px #fff; background:#fff; position: relative; }
    .plan-card.active .plan-radio{ border-color: var(--active); }
    .plan-card.active .plan-radio:after{ content:""; position:absolute; inset: 22%; background: var(--active); border-radius: 50%; }
    .plan-body{ display:grid; gap: clamp(0.2rem,1vw,0.4rem); text-align:left; }
    .plan-tier{ font-weight: 700; font-size: clamp(1rem,2.6vw,1.1rem); }
    .label-pill{ display:inline-block; padding: 0.2em 0.8em; border-radius: 999px; background:#771a30; color:#fff; font-weight:700; font-size: clamp(0.9rem,2.2vw,1rem); }
    .plan-right{ margin-left:auto; display:grid; gap: 0.2rem; align-items:center; justify-items:end; }
    .old-price{ color:#888; opacity:.7; text-decoration: line-through; font-weight:600; }
    .price-badge{ display:inline-grid; grid-auto-flow:column; align-items:baseline; gap: 0.35em; padding: 0.35em 0.75em; border-radius: 999px; background:#ff86b7; color:#000; font-weight:800; }
    .price-badge .per{ font-weight:600; opacity:.9; }
    .best-pill{ position:absolute; right: clamp(0.6rem,2.2vw,1rem); top: -0.9rem; background: var(--active); color:#fff; font-weight:800; border-radius:999px; padding: 0.25rem 0.7rem; font-size: clamp(0.8rem,2vw,0.95rem); }
    </style>
    <!-- Meta Pixel Code (dynamic pixel_id from URL) -->
    <script>
        (function(f,b,e,v,n,t,s){
            if(f.fbq)return;n=f.fbq=function(){n.callMethod?
            n.callMethod.apply(n,arguments):n.queue.push(arguments)};
            if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
            n.queue=[];t=b.createElement(e);t.async=!0;
            t.src=v;s=b.getElementsByTagName(e)[0];
            s.parentNode.insertBefore(t,s)
        })(window, document,'script','https://connect.facebook.net/en_US/fbevents.js');
        (function(){
            try {
                var params = new URLSearchParams(window.location.search);
                var pixelId = params.get('pixel_id') || '1352930370175119';
                fbq('init', pixelId);
                fbq('track', 'PageView');
            } catch (e) {
                fbq('init', '1352930370175119');
                fbq('track', 'PageView');
            }
        })();
    </script>
    <!-- End Meta Pixel Code -->
    <script src="./gf-pay-sdk/cherry-pay-sdk.js"></script>
    <script src="./paywall.js"></script>
    <script>
      // no-op
    </script>
</head>
<body data-step="16">
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=1352930370175119&ev=PageView&noscript=1"/></noscript>
<div class="screen payment-screen">
    <header class="topbar">
        <button id="backBtn" class="back-btn" aria-label="Back" onclick="goBack()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"
                 aria-hidden="true">
                <path d="M15 18L9 12L15 6" stroke="#FF2475" stroke-width="2" stroke-linecap="round"
                      stroke-linejoin="round"/>
            </svg>
        </button>
        <div class="title" aria-hidden="true"></div>
    </header>
    
    <main class="payment-section">
        <h2 class="payment-title">Choose your plan</h2>
        <div class="plans" id="plans" role="radiogroup" aria-label="Plans"></div>
        
        <div id="paywall-error" class="error-box" style="display:none"></div>
        <form id="form-el" onsubmit="submitRegistration(event)" class="paywall-form">
          <div class="paywall-row">
            <label for="emailInput" class="paywall-label">Email</label>
            <input id="emailInput" name="emailInput" type="email" class="paywall-input" placeholder="you@example.com" required />
          </div>
          <input type="hidden" name="product_id" id="product_id" value="2" />
          <input type="hidden" name="method_id" value="1" />
          <button type="submit" class="btn-primary">Continue</button>
        </form>
    </main>
</div>
<script>
    // Back button handler
    function goBack() {
        if (window.parent !== window) {
            window.parent.postMessage({ action: 'back' }, '*');
        } else {
            // Fallback if opened directly
            window.history.back();
        }
    }
    // Plans like on screenshot: 7 days (id 5), 1 month (id 2), 3 months (id 3)
    (function renderPlans(){
      var plansEl = document.getElementById('plans');
      if (!plansEl) return;
      var plans = [
        { id: '5', tier: 'Bronze', label: 'Weekly', badge: '', old: '$1.99', price: '$0.99', per: 'per day' },
        { id: '2', tier: 'Gold', label: 'Monthly', badge: 'Best price ðŸ”¥', old: '$1.66', price: '$0.66', per: 'per day', recommended: true },
        { id: '3', tier: 'Platinum', label: 'Quarterly', badge: '', old: '$1.55', price: '$0.55', per: 'per day' }
      ];
      var current = '2';
      plansEl.innerHTML = plans.map(function(p){
        var active = p.id === current;
        return (
          '<div class="plan-card'+(active?' active':'')+'" data-id="'+p.id+'" role="radio" aria-checked="'+(active?'true':'false')+'" tabindex="0">'
          + (p.badge?('<div class="best-pill">'+p.badge+'</div>'):'')
          + '<div class="plan-radio" aria-hidden="true"></div>'
          + '<div class="plan-body">'
          +   '<div class="plan-tier">'+p.tier+'</div>'
          +   '<div class="label-pill">'+p.label+'</div>'
          + '</div>'
          + '<div class="plan-right">'
          +   (p.old?('<div class="old-price">'+p.old+'</div>'):'')
          +   '<div class="price-badge"><span>'+p.price+'</span><span class="per">'+p.per+'</span></div>'
          + '</div>'
          + '</div>'
        );
      }).join('');
      function select(id){
        current = id;
        try { document.getElementById('product_id').value = id; } catch(e){}
        [].slice.call(plansEl.querySelectorAll('.plan-card')).forEach(function(card){
          var on = (card.getAttribute('data-id')===id);
          card.classList.toggle('active', on);
          card.setAttribute('aria-checked', on?'true':'false');
        });
      }
      plansEl.addEventListener('click', function(e){ var card=e.target.closest('.plan-card'); if (!card) return; select(card.getAttribute('data-id')); });
      plansEl.addEventListener('keydown', function(e){ if(e.key==='Enter'||e.key===' '){ var card=e.target.closest('.plan-card'); if (!card) return; e.preventDefault(); select(card.getAttribute('data-id')); }});
      select(current);
    })();
</script>
</body>
</html>